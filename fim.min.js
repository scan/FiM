(function(){parser=function(){function e(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var t={parse:function(t,n){function a(e,t,n){var r=e,i=n-e.length;for(var s=0;s<i;s++)r=t+r;return r}function f(e){var t=e.charCodeAt(0),n,r;return t<=255?(n="x",r=2):(n="u",r=4),"\\"+n+a(t.toString(16).toUpperCase(),"0",r)}function l(e){var t={};for(var n in e)t[n]=e[n];return t}function c(e,n){var r=e.offset+n;for(var i=e.offset;i<r;i++){var s=t.charAt(i);s==="\n"?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):s==="\r"||s==="\u2028"||s==="\u2029"?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}e.offset+=n}function h(e){if(i.offset<o.offset)return;i.offset>o.offset&&(o=l(i),u=[]),u.push(e)}function p(){var e,t,n,r;n=l(i),r=l(i),e=[],t=w();while(t!==null)e.push(t),t=w();return e!==null?(t=d(),t!==null?e=[e,t]:(e=null,i=l(r))):(e=null,i=l(r)),e!==null&&(e=function(e,t,n,r){return r}(n.offset,n.line,n.column,e[1])),e===null&&(i=l(n)),e}function d(){var e,n,r,o,u,a,f,p,d,m;d=l(i),m=l(i),t.substr(i.offset,24).toLowerCase()==="dear princess celestia: "?(e=t.substr(i.offset,24),c(i,24)):(e=null,s===0&&h('"Dear Princess Celestia: "'));if(e!==null){n=y();if(n!==null){r=w();if(r!==null){o=v();if(o!==null){u=g();if(u!==null){t.substr(i.offset,40).toLowerCase()==="your faithful student, twilight sparkle."?(a=t.substr(i.offset,40),c(i,40)):(a=null,s===0&&h('"Your Faithful Student, Twilight Sparkle."'));if(a!==null){f=[],t.length>i.offset?(p=t.charAt(i.offset),c(i,1)):(p=null,s===0&&h("any character"));while(p!==null)f.push(p),t.length>i.offset?(p=t.charAt(i.offset),c(i,1)):(p=null,s===0&&h("any character"));f!==null?e=[e,n,r,o,u,a,f]:(e=null,i=l(m))}else e=null,i=l(m)}else e=null,i=l(m)}else e=null,i=l(m)}else e=null,i=l(m)}else e=null,i=l(m)}else e=null,i=l(m);return e!==null&&(e=function(e,t,n,r,i,s){return{classname:r,code:i,main:s}}(d.offset,d.line,d.column,e[1],e[3],e[4])),e===null&&(i=l(d)),e}function v(){var e,t,n;n=l(i),e=[],t=m();while(t!==null)e.push(t),t=m();return e!==null&&(e=function(e,t,n,r){return r.filter(function(e){return!e.empty})}(n.offset,n.line,n.column,e)),e===null&&(i=l(n)),e}function m(){var e,n,r,o,u,a,f,p;f=l(i),p=l(i),t.substr(i.offset,2).toLowerCase()==="i "?(e=t.substr(i.offset,2),c(i,2)):(e=null,s===0&&h('"I "'));if(e!==null){t.substr(i.offset,4).toLowerCase()==="said"?(n=t.substr(i.offset,4),c(i,4)):(n=null,s===0&&h('"said"')),n===null&&(t.substr(i.offset,4).toLowerCase()==="sang"?(n=t.substr(i.offset,4),c(i,4)):(n=null,s===0&&h('"sang"')),n===null&&(t.substr(i.offset,5).toLowerCase()==="wrote"?(n=t.substr(i.offset,5),c(i,5)):(n=null,s===0&&h('"wrote"'))));if(n!==null){t.substr(i.offset,2)===' "'?(r=' "',c(i,2)):(r=null,s===0&&h('" \\""'));if(r!==null){o=[],/^[^"]/.test(t.charAt(i.offset))?(u=t.charAt(i.offset),c(i,1)):(u=null,s===0&&h('[^"]'));while(u!==null)o.push(u),/^[^"]/.test(t.charAt(i.offset))?(u=t.charAt(i.offset),c(i,1)):(u=null,s===0&&h('[^"]'));o!==null?(t.charCodeAt(i.offset)===34?(u='"',c(i,1)):(u=null,s===0&&h('"\\""')),u!==null?(a=w(),a!==null?e=[e,n,r,o,u,a]:(e=null,i=l(p))):(e=null,i=l(p))):(e=null,i=l(p))}else e=null,i=l(p)}else e=null,i=l(p)}else e=null,i=l(p);return e!==null&&(e=function(e,t,n,r){return{print:r.join("")+"\n"}}(f.offset,f.line,f.column,e[3])),e===null&&(i=l(f)),e===null&&(f=l(i),e=w(),e!==null&&(e=function(e,t,n){return{empty:!0}}(f.offset,f.line,f.column)),e===null&&(i=l(f))),e}function g(){var e,n,r,o,u,a;u=l(i),a=l(i),t.substr(i.offset,16).toLowerCase()==="today i learned "?(e=t.substr(i.offset,16),c(i,16)):(e=null,s===0&&h('"Today I learned "'));if(e!==null){n=[],/^[^\n\r]/.test(t.charAt(i.offset))?(r=t.charAt(i.offset),c(i,1)):(r=null,s===0&&h("[^\\n\\r]"));while(r!==null)n.push(r),/^[^\n\r]/.test(t.charAt(i.offset))?(r=t.charAt(i.offset),c(i,1)):(r=null,s===0&&h("[^\\n\\r]"));n!==null?(r=w(),r!==null?(o=v(),o!==null?e=[e,n,r,o]:(e=null,i=l(a))):(e=null,i=l(a))):(e=null,i=l(a))}else e=null,i=l(a);return e!==null&&(e=function(e,t,n,r){return r}(u.offset,u.line,u.column,e[3])),e===null&&(i=l(u)),e}function y(){var e,n,r,o,u,a,f,p;u=l(i),a=l(i),e=b();if(e!==null){n=[],f=l(i),p=l(i),t.charCodeAt(i.offset)===32?(r=" ",c(i,1)):(r=null,s===0&&h('" "')),r!==null?(o=b(),o!==null?r=[r,o]:(r=null,i=l(p))):(r=null,i=l(p)),r!==null&&(r=function(e,t,n,r){return" "+r}(f.offset,f.line,f.column,r[1])),r===null&&(i=l(f));while(r!==null)n.push(r),f=l(i),p=l(i),t.charCodeAt(i.offset)===32?(r=" ",c(i,1)):(r=null,s===0&&h('" "')),r!==null?(o=b(),o!==null?r=[r,o]:(r=null,i=l(p))):(r=null,i=l(p)),r!==null&&(r=function(e,t,n,r){return" "+r}(f.offset,f.line,f.column,r[1])),r===null&&(i=l(f));n!==null?e=[e,n]:(e=null,i=l(a))}else e=null,i=l(a);return e!==null&&(e=function(e,t,n,r,i){return r+i.join("")}(u.offset,u.line,u.column,e[0],e[1])),e===null&&(i=l(u)),e}function b(){var e,n,r,o,u;o=l(i),u=l(i),/^[A-Z]/.test(t.charAt(i.offset))?(e=t.charAt(i.offset),c(i,1)):(e=null,s===0&&h("[A-Z]"));if(e!==null){n=[],/^[a-z]/.test(t.charAt(i.offset))?(r=t.charAt(i.offset),c(i,1)):(r=null,s===0&&h("[a-z]"));while(r!==null)n.push(r),/^[a-z]/.test(t.charAt(i.offset))?(r=t.charAt(i.offset),c(i,1)):(r=null,s===0&&h("[a-z]"));n!==null?e=[e,n]:(e=null,i=l(u))}else e=null,i=l(u);return e!==null&&(e=function(e,t,n,r,i){return r+i.join("")}(o.offset,o.line,o.column,e[0],e[1])),e===null&&(i=l(o)),e}function w(){var e;return t.substr(i.offset,2)==="\r\n"?(e="\r\n",c(i,2)):(e=null,s===0&&h('"\\r\\n"')),e===null&&(t.charCodeAt(i.offset)===10?(e="\n",c(i,1)):(e=null,s===0&&h('"\\n"')),e===null&&(t.charCodeAt(i.offset)===13?(e="\r",c(i,1)):(e=null,s===0&&h('"\\r"')))),e}function E(e){e.sort();var t=null,n=[];for(var r=0;r<e.length;r++)e[r]!==t&&(n.push(e[r]),t=e[r]);return n}var r={start:p,"class":d,block:v,line:m,main:g,identifier:y,word:b,EOL:w};if(n!==undefined){if(r[n]===undefined)throw new Error("Invalid rule name: "+e(n)+".")}else n="start";var i={offset:0,line:1,column:1,seenCR:!1},s=0,o={offset:0,line:1,column:1,seenCR:!1},u=[],S=r[n]();if(S===null||i.offset!==t.length){var x=Math.max(i.offset,o.offset),T=x<t.length?t.charAt(x):null,N=i.offset>o.offset?i:o;throw new this.SyntaxError(E(u),T,x,N.line,N.column)}return S},toSource:function(){return this._source}};return t.SyntaxError=function(t,n,r,i,s){function o(t,n){var r,i;switch(t.length){case 0:r="end of input";break;case 1:r=t[0];break;default:r=t.slice(0,t.length-1).join(", ")+" or "+t[t.length-1]}return i=n?e(n):"end of input","Expected "+r+" but "+i+" found."}this.name="SyntaxError",this.expected=t,this.found=n,this.message=o(t,n),this.offset=r,this.line=i,this.column=s},t.SyntaxError.prototype=Error.prototype,t}(),window.FiM={interprete:function(e,t){var n,r,i;return t==null&&(t={}),i=t.stdout||console.log,n=t.stderr||console.log,r=t.stdin||window.prompt,function(){var t,n,r,s,o,u;n=parser.parse(e),console.log("Executing..."),o=n.main,u=[];for(r=0,s=o.length;r<s;r++)t=o[r],t.print!=null?u.push(i(t.print)):u.push(void 0);return u}()}}}).call(this)